{% extends 'base.html' %}
{% block extrahead %}
    <script src="//cdn.bootcss.com/jquery-confirm/2.5.1/jquery-confirm.min.js"></script>
    <link href="//cdn.bootcss.com/jquery-confirm/2.5.1/jquery-confirm.min.css" rel="stylesheet">
{% endblock %}
{% block content %}
    <form method="post">
        {% csrf_token %}
        <h2>选择题</h2>
        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
            {% for choice_problem in choice_problems %}
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="heading{{ choice_problem.detail.id }}">
                        <h4 class="panel-title">
                            <a {% if not forloop.first %}class="collapsed"{% endif %}role="button"
                               data-toggle="collapse"
                               data-parent="#accordion"
                               href="#collapse{{ choice_problem.detail.id }}"
                               aria-expanded="{% if forloop.first %}true{% else %}false{% endif %}"
                               aria-controls="collapse{{ choice_problem.detail.id }}">
                                {{ forloop.counter }}. ({{ choice_problem.score }}分) {{ choice_problem.detail.title }}
                            </a>
                        </h4>
                    </div>
                    <div id="collapse{{ choice_problem.detail.id }}"
                         class="panel-collapse collapse {% if forloop.first %}in{% endif %}" role="tabpanel"
                         aria-labelledby="heading{{ choice_problem.detail.id }}">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-lg-6 col-md-6">
                                    <label class="checkbox-inline">
                                        <input type="radio" id="selection-{{ choice_problem.detail.id }}" value="a"
                                               name="selection-{{ choice_problem.detail.id }}">
                                        A.{{ choice_problem.detail.a }}
                                    </label>
                                </div>
                                <div class="col-lg-6 col-md-6 ">
                                    <label class="checkbox-inline">
                                        <input type="radio" id="selection-{{ choice_problem.detail.id }}" value="b"
                                               name="selection-{{ choice_problem.detail.id }}">
                                        B.{{ choice_problem.detail.b }}
                                    </label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6 col-md-6">
                                    <label class="checkbox-inline">
                                        <input type="radio" id="selection-{{ choice_problem.detail.id }}" value="c"
                                               name="selection-{{ choice_problem.detail.id }}">
                                        C.{{ choice_problem.detail.c }}
                                    </label>
                                </div>
                                <div class="col-lg-6 col-md-6">
                                    <label class="checkbox-inline">
                                        <input type="radio" id="selection-{{ choice_problem.detail.id }}" value="d"
                                               name="selection-{{ choice_problem.detail.id }}">
                                        D.{{ choice_problem.detail.d }}
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}

        </div>
        <h2>编程题</h2>
        <div class="panel-group" id="accordion2" role="tablist" aria-multiselectable="true">
            {% for problem in problems %}
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="heading-{{ problem.problem_id }}">
                        <h4 class="panel-title">
                            <a {% if not forloop.first %}class="collapsed"{% endif %}role="button"
                               data-toggle="collapse"
                               data-parent="#accordion2"
                               href="#collapse-{{ problem.problem_id }}"
                               aria-expanded="{% if forloop.first %}true{% else %}false{% endif %}"
                               aria-controls="collapse-{{ problem.problem_id }}">
                                {{ forloop.counter }}.{{ problem.title }}
                            </a>
                        </h4>
                    </div>
                    <div id="collapse-{{ problem.problem_id }}"
                         class="panel-collapse collapse {% if forloop.first %}in{% endif %}"
                         role="tabpanel"
                         aria-labelledby="heading-{{ problem.problem_id }}">
                        <div class="panel-body">
                            <div class="section">
                                <h4><span class="label label-primary">题目描述</span></h4>
                                <div id="description"><p>  {{ problem.description }}</p></div>
                            </div>
                            <div class="section">
                                <h4><span class="label label-primary">输入</span></h4>
                                <div id="input"><p>  {{ problem.input }}</p></div>
                            </div>
                            <div class="section">
                                <h4><span class="label label-primary">输出</span></h4>
                                <div id="output"><p>  {{ problem.output }}</p></div>
                            </div>
                            {% if problem.sample_output %}
                                <div class="section">
                                    <h4><span class="label label-info">样例输入1:</span></h4>
                                    <div id="sample_input">
                                        <pre>  {{ problem.sample_input }}</pre>
                                    </div>
                                </div>
                                <div class="section">
                                    <h4><span class="label label-info">样例输出1:</span></h4>
                                    <div id="sample_output">
                                        <pre>  {{ problem.sample_output }}</pre>
                                    </div>
                                </div>
                            {% endif %}
                            {% if problem.sample_output2 %}
                                <div class="section">
                                    <h4><span class="label label-primary">样例输入2:</span></h4>
                                    <div id="sample_input2">
                                        <pre> {{ problem.sample_input2 }}</pre>
                                    </div>
                                </div>
                                <div class="section">
                                    <h4><span class="label label-primary">样例输出2:</span></h4>
                                    <div id="sample_output2">
                                        <pre>  {{ problem.sample_output2 }}</pre>
                                    </div>
                                </div>
                            {% endif %}
                            <div id="answer-area">
                                <div class="form-group">
                                    <label for="language" class="control-label">语言</label>
                                    <select name="language-{{ problem.problem_id }}" class="form-control language"
                                            id="language-{{ problem.problem_id }}">

                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="source{{ problem.problem_id }}">代码</label>
                                <textarea class="form-control" cols="50" rows="10"
                                          name="source-{{ problem.problem_id }}"
                                          id="source{{ problem.problem_id }}" spellcheck="false"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

    </form>
    <button class="btn btn-default" onclick="check()">保存</button>
    <script>
        var languages = {
            0: 'C',
            1: 'C++',
            2: 'Pascal',
            3: 'Java',
            4: 'Ruby',
            5: 'Bash',
            6: 'Python'
        };
        var allowed_languages = '{{ homework.allowed_languages }}';
        for (var p in allowed_languages.split(',')) {
            $(".language").append("<option value=\"" + p + "\">" + languages[p] + "</option>");
        }
        function check() {
            $.confirm({
                title: '确认提交',
                content: '确定要提交作业吗？提交后您将无法再修改答案',
                confirmButton: '我已检查完成，确定提交',
                cancelButton: '取消',
                confirmButtonClass: 'btn-info',
                cancelButtonClass: 'btn-danger',
                confirm: function () {
                    $("form").submit();
                }
            });
        }
    </script>
{% endblock %}